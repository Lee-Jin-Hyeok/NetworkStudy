## VLAN

### 1. VLAN이란?

VLAN은 Virtual LAN의 약자로, LAN을 가상으로 나누어서 브로드캐스트할 때 생기는 트래픽을 줄이는 기술이다.
모든 스위치(Switch:2계층 네트워크 장비)는 VLAN 기능을 모두 가지고 있다.

### 2. VLAN을 사용해야 하는 이유

VLAN이 무엇인지를 안 순간부터 VLAN을 사용해야 하는 이유에 대해서 알 수 있다.
기존의 LAN에서는 ARP와 같은 프로토콜은 브로드캐스트로 패킷을 보낸다.
브로드캐스트로 패킷을 보낼 때에는 같은 LAN에 존재하는 모든 네트워크 장비에게 패킷을 보내기 때문에
네트워크 장비가 많은 회사같은 경우에는 브로드캐스트가 발생하게 되면 많은 네트워크 장비에게
쓸데없는 패킷을 보내야 하기 때문에 많은 트래픽이 발생할 수 있다.
그렇기 때문에 이런 쓸데없는 트래픽을 제거하기 위해서 VLAN을 사용해야 한다.

### 3. VLAN 사용하기

VLAN을 사용하기 위해서 스위치에 설정을 해주어야 하는데
이러한 네트워크 통신과 같은 기술을 쉽게 표현할 수 있는
Package Tracer(패킷 트레이서)라는 프로그램을 이용하겠다.

우리는 다음과 같은 네트워크 망을 패킷 트레이서를 이용해서 구현할 것이다.
![VLAN](./img/VLAN_Test.jpg)

하나의 네트워크 망으로 되어 있고 두 개의 스위치가 존재하며
각각의 스위치에는 두 대의 PC(네트워크 장비)가 존재한다.

이런 경우 스위치 두 개와 네 대의 PC 모두 하나의 랜에 존재하게 된다.
가장 왼쪽의 PC부터 IP를 192.168.10.1, 192.168.10.2, 192.168.10.3, 192.168.10.4로 지정한다.
그러면 가장 왼쪽의 PC가 192.168.10.4로 ping 명령을 보내면 PC3에게 ICMP 패킷을 보내기 위해서
ARP 패킷을 보내게 될 것이고 그 과정에서 브로드캐스트를 보내면 PC3 뿐만 아니라 PC1, PC2도
브로드캐스트로 인한 ARP 패킷을 받게 될 것입니다.

그런데 만약 하나의 스위치당 수많은 PC가 있다면 브로드캐스트할 때 엄청난 트래픽이 발생하게 될 것입니다.
그래서 스위치는 VLAN이라는 가상 랜을 지원하게 된다.

VLAN을 사용하는 방법은 스위치에 설정을 하면 된다.
스위치 포트에는 4가지 모드가 존재하는데 우리는 일반적으로 사용하는 억세스 포트(access port)와
스위치끼리 지나갈 때 VLAN 정보를 저장하라는 포트인 트런크 포트(trunk port) 모드가 존재한다.
따라서 스위치끼리는 트런크 포트를 사용하고 PC에는 억세스 포트를 사용한다.
이 모드를 변경하는 방법은 스위치의 config에 다음과 같이 명령어를 작성하면 된다.

```java
Switch> enable			// 관리자 명령 프롬프트로 변경
Switch# config ter		// 터미널창의 설정을 사용함
Switch(config)# interface fa0/2
Switch(config-if)# switchport mode access
Switch(config-if)# switchport access vlan 10 
```

이를 모든 PC에 적용하면 된다.
트런크 포트를 설정할 때는 다음과 같이 하면 된다.

```java
Switch> enable
Switch# config ter
Switch(config)# interface fa0/3
Switch(config-if)# switchport mode trunk
Switch(config-if)# switchport trunk
```

이제 각각의 PC에 다른 네트워크 대역을 작성하며 VLAN을 다르게 설정해주면 알아서
다른 네트워크 대역으로 인지하여 브로드캐스트 트래픽을 줄일 수 있다.